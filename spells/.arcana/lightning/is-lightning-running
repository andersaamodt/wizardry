#!/bin/sh

# Check if Lightning daemon is currently running.

case "${1-}" in
--help|--usage|-h)
  cat <<'USAGE'
Usage: is-lightning-running

Checks whether lightningd is active; exits 0 if running, 1 if not.
USAGE
  exit 0
  ;;
esac

require-wizardry || exit 1

set -eu
. env-clear

# Check if lightningd process is running
if ps -e | grep -q '[l]ightningd'; then
    if [ -t 1 ]; then  # Check if output is a terminal
        echo "Lightning is running."
    fi
    exit 0  # Lightning is running (success)
else
    if [ -t 1 ]; then  # Check if output is a terminal
        echo "Lightning is not running."
    fi
    exit 1  # Lightning is not running (failure)
fi
