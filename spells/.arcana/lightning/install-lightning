#!/bin/sh

# Install and configure Bitcoin Lightning (Core Lightning) across supported platforms.

case "${1-}" in
--help|--usage|-h)
  cat <<'USAGE'
Usage: install-lightning

Guides you through installing Bitcoin Lightning (Core Lightning). On NixOS, this will add
clightning to environment.systemPackages when possible and run sudo nixos-rebuild all.
USAGE
  exit 0
  ;;
esac

require-wizardry || exit 1

set -eu
env_clear

ask() {
  prompt=${1-}
  default=${2-}
  if [ -n "$default" ]; then
    printf "%s [%s]: " "$prompt" "$default"
  else
    printf "%s: " "$prompt"
  fi
  read -r reply
  if [ -z "$reply" ] && [ -n "$default" ]; then
    reply=$default
  fi
  printf '%s' "$reply"
