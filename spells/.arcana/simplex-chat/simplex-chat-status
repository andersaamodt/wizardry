#!/bin/sh

# Report installation and setup status for simplex-chat.

case "${1-}" in
--help|--usage|-h)
  cat <<'USAGE'
Usage: simplex-chat-status

Reports whether simplex-chat is installed and ready to use, highlighting missing configuration or errors.
USAGE
  exit 0
  ;;
esac

require-wizardry || exit 1

set -eu
. env-clear

if command -v colors >/dev/null 2>&1; then
  # shellcheck source=/dev/null
  . colors
else
  RESET=""
  THEME_SUCCESS=""
  THEME_WARNING=""
  THEME_ERROR=""
  GREY=""
fi
# Older scripts expect GRAY, so mirror GREY when missing.
GRAY=${GREY-}

simplex_chat_status_color_for_status() {
  case "$1" in
    "installed")
      printf "%s" "$THEME_SUCCESS"
      ;;
    "installed, needs setup")
      printf "%s" "$THEME_WARNING"
      ;;
    "not installed")
      printf "%s" "$GRAY"
      ;;
    *)
      printf "%s" "$THEME_ERROR"
      ;;
  esac
