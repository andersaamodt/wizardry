#!/bin/sh

# List installed LLMs.

case "${1-}" in
--help|--usage|-h)
  cat <<'USAGE'
Usage: list-installed-llms

Lists LLMs currently installed in ollama.
USAGE
  exit 0
  ;;
esac

set -eu
. env-clear

script_dir=$(CDPATH= cd -- "$(dirname "$0")" && pwd)

# Check if ollama is installed
if ! "$script_dir/is-ai-component-installed" ollama 2>/dev/null; then
  exit 0
fi

# Get ollama binary
if has ollama; then
  ollama_bin="ollama"
elif [ -x "$HOME/.local/bin/ollama" ]; then
  ollama_bin="$HOME/.local/bin/ollama"
else
  exit 0
fi

# List installed models
$ollama_bin list 2>/dev/null | tail -n +2 | awk '{print $1}' || exit 0
