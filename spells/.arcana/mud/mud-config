#!/bin/sh

# Manage MUD feature configuration stored in $SPELLBOOK_DIR/.mud

case "${1-}" in
--help|--usage|-h)
  cat <<'USAGE'
Usage: mud-config {get|set|toggle|list} [FEATURE] [VALUE]

Manage MUD feature toggles stored in $SPELLBOOK_DIR/.mud. Supports get, set, toggle, and list for features like parse-enabled, command-not-found, touch-hook, fantasy-theme, inventory, and combat.
USAGE
  exit 0
  ;;
esac

require-wizardry || exit 1

set -eu
. env-clear

# Resolve config file
spell_home=$(env-or SPELLBOOK_DIR "${HOME:-.}/.spellbook")
config_file="$spell_home/.mud"

# Ensure spellbook directory exists
if [ ! -d "$spell_home" ]; then
  mkdir -p "$spell_home" || {
    printf '%s\n' "mud-config: cannot create spellbook directory '$spell_home'" >&2
    exit 1
  }
fi

# Display or manage MUD configuration
if [ -f "$config_file" ]; then
  cat "$config_file"
else
  printf '%s\n' "MUD configuration file not found at: $config_file"
fi
