#!/bin/sh

# Assert that coreutils are installed.

case "${1-}" in
--help|--usage|-h)
  cat <<'USAGE'
Usage: install-coreutils

Checks that core utilities are present. This is assert-only - coreutils should already be installed on all systems.
USAGE
  exit 0
  ;;
esac

require-wizardry || exit 1

set -eu
. env-clear

# Check for essential coreutils commands
missing=""
for cmd in cat cp mv rm ls mkdir chmod readlink; do
  if ! command -v "$cmd" >/dev/null 2>&1; then
    missing="$missing $cmd"
  fi
done

if [ -n "$missing" ]; then
  printf '%s\n' "install-coreutils: missing commands:$missing" >&2
  printf '%s\n' "Coreutils should be installed by your system. Please install them manually." >&2
  exit 1
fi

printf '%s\n' "Coreutils are already installed."
