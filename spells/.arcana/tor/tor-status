#!/bin/sh

# This spell checks and displays the running status of Tor.

case "${1-}" in
--help|--usage|-h)
  cat <<'USAGE'
Usage: tor-status

Reports whether Tor is installed, running, and bootstrapped by inspecting systemd status and recent logs.
USAGE
  exit 0
  ;;
esac

require_wizardry || exit 1

set -eu
env_clear
. colors

# Returns colored text based on status
tor_status_color_for_status() {
  case "$1" in
    "installed, running, bootstrapped")
      printf "${GREEN}"
      ;;
    "not installed")
      printf "${GRAY}"
      ;;
    "installed, not running"|"installed, running, bootstrapping")
      printf "${YELLOW}"
      ;;
    "installed, running, disconnected"|"installed, running, error"|"*")
      printf "${RED}"
      ;;
  esac
