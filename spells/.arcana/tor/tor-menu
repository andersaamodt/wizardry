#!/bin/sh

# Present the Tor management menu.

case "${1-}" in
--help|--usage|-h)
  cat <<'USAGE'
Usage: tor-menu

Displays the Tor management menu.
USAGE
  exit 0
  ;;
esac

require_wizardry || exit 1

set -eu
env_clear
. colors

# Catch Ctrl-C and TERM signal to exit cleanly
trap 'exit 0' INT TERM

build_service_entries() {
  service_status_option=""
  tor_service_option=""

  if is-service-installed tor > /dev/null; then
    service_status_option="View Tor Service Status%sudo systemctl status tor"
    if is-service-running tor > /dev/null; then
      tor_service_option="Stop Tor Service%sudo systemctl stop tor"
    else
      tor_service_option="Start Tor Service%sudo systemctl start tor"
    fi
  else
    script_dir=$(cd -P -- "$(dirname -- "$0")" && pwd -P)
    service_status_option="Install Tor Service%install-service-template $script_dir/tor.service \"TORPATH=\$(command -v tor)\" \"TORRCPATH=/etc/tor/torrc\""
  fi
