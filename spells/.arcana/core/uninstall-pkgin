#!/bin/sh

# Bootstrap spell: Uninstall pkgin package manager.

case "${1-}" in
--help|--usage|-h)
  cat <<'USAGE'
Usage: uninstall-pkgin

This spell uninstalls pkgin (pkgsrc package manager) from macOS.
This removes the entire /opt/pkg directory.
USAGE
  exit 0
  ;;
esac

set -eu

# Check if pkgin is installed
if ! [ -d /opt/pkg ]; then
  printf '%s\n' "pkgin is not installed (no /opt/pkg directory found)"
  exit 0
fi

printf '%s\n' "Uninstalling pkgin package manager..."
printf '%s\n' "This will remove the entire /opt/pkg directory (requires sudo)..."

# Remove pkgsrc installation
if ! sudo rm -rf /opt/pkg; then
  printf '%s\n' "uninstall-pkgin: failed to remove /opt/pkg directory" >&2
  exit 1
fi

printf '%s\n' "pkgin uninstalled successfully"
printf '%s\n' "Remember to remove /opt/pkg/bin and /opt/pkg/sbin from your PATH"
