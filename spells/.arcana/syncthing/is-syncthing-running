#!/bin/sh

# Check if Syncthing is currently running.

case "${1-}" in
--help|--usage|-h)
  cat <<'USAGE'
Usage: is-syncthing-running

Returns 0 if Syncthing is running, 1 otherwise.
USAGE
  exit 0
  ;;
esac

# Note: No set -eu because this is a conditional script (returns exit codes)
set +eu

# Check if syncthing process is running
if pgrep -x syncthing >/dev/null 2>&1; then
  exit 0
fi

# Also check if systemd service is running (if systemctl is available)
if command -v systemctl >/dev/null 2>&1; then
  if systemctl is-active --quiet syncthing@"$(whoami)" 2>/dev/null || \
     systemctl is-active --quiet syncthing 2>/dev/null; then
    exit 0
  fi
fi

exit 1
