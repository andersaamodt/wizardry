#!/bin/sh
# Network configuration menu - work in progress

case "${1-}" in
--help|--usage|-h)
  cat <<'USAGE'
Usage: network-menu

Displays network configuration options.
USAGE
  exit 0
  ;;
esac

set -eu
. env-clear

require-command menu || exit 1

# Catch Ctrl-C and TERM signal to exit cleanly
# INT (Ctrl-C) should exit 130, TERM should exit 0
trap 'exit 130' INT
trap 'exit 0' TERM
exit_label=$(exit-label)
# Exit button kills this menu script via TERM signal
# Menu (child process) evals: kill -TERM $PPID â†’ kills its parent (this script)
exit_item="${exit_label}%kill -TERM \$PPID"

menu "Network Menu:" \
  "Configure static IP%configure-static-ip" \
  "Configure DHCP%configure-dhcp" \
  "$exit_item" || menu_status=$?
menu_status=${menu_status:-0}

# ESC causes menu to exit with 130 - handle gracefully by exiting
if [ "$menu_status" -eq 130 ]; then
  printf 'ESC\n' >&2
  exit 0
fi

