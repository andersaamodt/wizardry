#!/bin/sh

# This spell runs a provided command against every file in the current directory.
# Use it as a batch helper to apply one incantation across many files.


case "${1-}" in
--help|--usage|-h)
  forall_usage
  exit 0
  ;;
esac

set -eu
. env-clear

forall_usage() {


if [ "$#" -lt 1 ]; then
        forall_usage >&2
        return 1
fi

for file in ./*; do
        printf '%s\n' "${file#./}"
    "$@" "$file" | awk '{print "   " $0}'
done
}

# Self-execute when run directly (not sourced)
case "$0" in
  */forall) forall "$@" ;; esac
