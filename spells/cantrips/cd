#!/bin/sh

install_cd() {
  if ! grep -q "alias cd=" "$HOME/.bashrc" 2>/dev/null; then
    if ! command -v ask_yn >/dev/null 2>&1; then
      printf '%s\n' "cd cantrip: ask_yn spell is missing; cannot prompt for installation." >&2
      return 1
    fi
    if ask_yn "Memorize the enhanced 'cd' spell so it always looks around?" yes >/dev/null; then
      scriptpath="$(dirname $(readlink -f $0))"
      filename="$(basename "$0")"
      printf "alias cd=\". %s/%s\"\n" "$scriptpath" "$filename" >> "$HOME/.bashrc"
      echo "Spell memorized in .bashrc, so the mud will always be active in the terminal."
    else
      echo "The mud will only run in this shell window."
    fi
  fi
}

install_cd

# Call the standard cd command
builtin cd "$@"
	
# Look around the room
look
