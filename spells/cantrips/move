#!/bin/sh

from=
to=

handle_args(){
    for arg in "$@"; do
        case $arg in
            "from")
                from="$2"
                shift 2
                ;;
            "to")
                to="$2"
                shift 2
                ;;
            *)
                if [ -z "$from" ]; then
                    from="$arg"
                else
                    to="$arg"
                fi
                ;;
        esac
    done
}

check_permission(){
    if [ ! -r "$to" ]; then
        echo "You do not have read permission on $to. Exiting."
        exit 1
    fi
}

check_path(){
    if [ -z "$to" ]; then
        echo "Please specify the destination path."
        exit 1
    fi
}

handle_menu(){
    local choice
    PS3="Choose action:"
    options="Rename file Move to different folder Move to home directory Move up one level"
    choice=$(echo $options | tr ' ' '\n' | nl -v 0 -w 2 | sort -k2 | awk '{print $1 ") " $2}' | tr '\n' ' ')
    echo " $choice"
    read -p "Choose an action: " action
    case $action in
        1)
            read -p "Enter new file name: " newname
            mv "$from" "$newname"
            ;;
        2)
            read -p "Enter destination folder path: " to
            mv "$from" "$to"
            ;;
        3)
            to=$HOME
            mv "$from" "$to"
            ;;
        4)
            to=$(dirname "$from")
            mv "$from" "$to"
            ;;
        *)
            echo "Invalid option"
            ;;
    esac
}

handle_args "$@"
check_path
check_permission
handle_menu
