#!/bin/sh

# This spell outputs a cd command to navigate up directory levels.
# Source it or use with eval: eval "$(up)" or eval "$(up 2)"

case "${1-}" in
--help|--usage|-h)
  cat <<'USAGE'
Usage: up [levels]

Print a cd command that climbs the given number of directory levels. Defaults to one level and is meant to be wrapped with eval or sourced so your shell follows the path.
USAGE
  exit 0
  ;;
esac

set -eu

levels=${1:-1}

# Validate levels is a positive integer
# Note: env_clear disables set -e, so we must explicitly return after die
case "$levels" in
        ''|*[!0-9]*|0)
                die "up: levels must be a positive integer."
                exit 1
                ;;
esac

# Build the relative path
path=".."
i=1
while [ "$i" -lt "$levels" ]; do
        path="$path/.."
        i=$((i + 1))
done

printf 'cd "%s"\n' "$path"
