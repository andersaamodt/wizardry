#!/usr/bin/env sh

# This magical knowledge serves as a colorful palette of hues and shades,
# granting control over the appearance of the terminal.
# Use these variables to add color to your writing.
# Example: printf '%sError:%s An error message.\n' "${RED}" "${RESET}"
# This script contains all color codes in the POSIX standard.
# You must source this script with '. ./colors' (or an absolute path) to use it.

# Record whether the terminal appears to support ANSI escape sequences so
# callers can disable colour-aware features when needed.
WIZARDRY_COLORS_AVAILABLE=1

disable_palette() {
        for name in \
                RESET BLACK RED GREEN YELLOW BLUE PURPLE CYAN WHITE GREY \
                BOLD ITALICS UNDERLINED BLINK INVERT STRIKE \
                BRIGHT_BLACK BRIGHT_RED BRIGHT_GREEN BRIGHT_YELLOW \
                BRIGHT_BLUE BRIGHT_PURPLE BRIGHT_CYAN BRIGHT_WHITE \
                BG_BLACK BG_RED BG_GREEN BG_YELLOW BG_BLUE BG_PURPLE \
                BG_CYAN BG_WHITE BG_BRIGHT_BLACK BG_BRIGHT_RED \
                BG_BRIGHT_GREEN BG_BRIGHT_YELLOW BG_BRIGHT_BLUE \
                BG_BRIGHT_PURPLE BG_BRIGHT_CYAN BG_BRIGHT_WHITE
        do
                eval "$name=''"
        done
        WIZARDRY_COLORS_AVAILABLE=0
}

# Create the escape character in a POSIX-compliant way.
# This stores the actual escape character (ASCII 27) in the variable,
# so that printf '%s' "$COLOR" works correctly.
ESC=$(printf '\033')

# Reset all attributes to their default values.
RESET="${ESC}[0m"

# Colours.
BLACK="${ESC}[30m"
RED="${ESC}[31m"
GREEN="${ESC}[32m"
YELLOW="${ESC}[33m"
BLUE="${ESC}[34m"
PURPLE="${ESC}[35m"
CYAN="${ESC}[36m"
WHITE="${ESC}[37m" # Or is this default/white?
GREY="${ESC}[2m"

# Formatting.
BOLD="${ESC}[1m"
ITALICS="${ESC}[3m" #or 3?
UNDERLINED="${ESC}[4m"
BLINK="${ESC}[5m"
INVERT="${ESC}[7m"
STRIKE="${ESC}[9m" # Strikethrough

# Bright colours.
BRIGHT_BLACK="${ESC}[30;1m"
BRIGHT_RED="${ESC}[31;1m"
BRIGHT_GREEN="${ESC}[32;1m"
BRIGHT_YELLOW="${ESC}[33;1m"
BRIGHT_BLUE="${ESC}[34;1m"
BRIGHT_PURPLE="${ESC}[35;1m"
BRIGHT_CYAN="${ESC}[36;1m"
BRIGHT_WHITE="${ESC}[37;1m"

# Background colours.
BG_BLACK="${ESC}[40m"
BG_RED="${ESC}[41m"
BG_GREEN="${ESC}[42m"
BG_YELLOW="${ESC}[43m"
BG_BLUE="${ESC}[44m"
BG_PURPLE="${ESC}[45m"
BG_CYAN="${ESC}[46m"
BG_WHITE="${ESC}[47m"

# Bright background colours.
BG_BRIGHT_BLACK="${ESC}[40;1m"
BG_BRIGHT_RED="${ESC}[41;1m"
BG_BRIGHT_GREEN="${ESC}[42;1m"
BG_BRIGHT_YELLOW="${ESC}[103m"
BG_BRIGHT_BLUE="${ESC}[104m"
BG_BRIGHT_PURPLE="${ESC}[105m"
BG_BRIGHT_CYAN="${ESC}[106m"
BG_BRIGHT_WHITE="${ESC}[107m"

# Allow the user or terminal capabilities to disable colour output entirely.
case ${NO_COLOR-} in
        '' ) : ;;
        * ) disable_palette ;;
esac

case ${TERM-} in
        ''|dumb|unknown)
                disable_palette
                ;;
        *)
                if command -v tput >/dev/null 2>&1; then
                        colors=$(tput colors 2>/dev/null || printf '')
                        case ${colors:-} in
                                ''|0)
                                        disable_palette
                                        ;;
                        esac
                fi
                ;;
esac
