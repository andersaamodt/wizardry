#!/bin/sh
# make-indent LEVEL [FILE] - generate indentation string for a given level
# Uses detected indent style from FILE, or defaults to 2 spaces. Example: indent=$(make-indent 2)
set -eu


mi_level=${1:-1}
mi_file=${2-}
mi_imp_dir=$(CDPATH= cd -- "$(dirname "$0")" && pwd -P)

if [ -n "$mi_file" ] && [ -f "$mi_file" ]; then
  mi_char=$("$mi_imp_dir/detect-indent-char" "$mi_file")
  mi_width=$("$mi_imp_dir/detect-indent-width" "$mi_file")
else
  mi_char=space
  mi_width=2
fi

case $mi_char in
  tab)
    mi_i=0
    while [ "$mi_i" -lt "$mi_level" ]; do
      printf '\t'
      mi_i=$((_mi_i + 1))
    done
    ;;
  *)
    mi_total=$((_mi_level * _mi_width))
    mi_i=0
    while [ "$mi_i" -lt "$mi_total" ]; do
      printf ' '
      mi_i=$((_mi_i + 1))
    done
    ;;
esac
