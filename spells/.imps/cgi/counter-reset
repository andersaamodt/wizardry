#!/bin/sh
# counter-reset - Reset the counter to zero
set -eu

http-status 200 "OK"
http-header "Content-Type" "text/html"
http-end-headers

# Use site-specific counter based on HTTP_HOST
site_id=$(printf '%s' "${HTTP_HOST:-localhost}" | sed 's/[^a-zA-Z0-9]/-/g')
counter_file="${TMPDIR:-/tmp}/wizardry-counter-${site_id}.txt"

# Reset to zero
echo "0" > "$counter_file"

cat <<HTML
<div class="demo-result counter">
  <h2>0</h2>
  <p class="meta">Counter reset!</p>
</div>
HTML
