#!/bin/sh
# sse-start - Initialize Server-Sent Events stream with padding
# Outputs HTTP headers and initial padding burst to force buffer flush
set -eu

http-status 200 "OK"
http-header "Content-Type" "text/event-stream"
http-header "Cache-Control" "no-cache"
http-header "Connection" "keep-alive"
http-header "X-Accel-Buffering" "no"
http-end-headers

# Send initial padding burst (4KB) to force fcgiwrap buffer flush immediately
# This ensures headers reach the browser right away
sse-padding 4
printf '\n'

# Set reconnection retry interval (5 seconds)
# Guides browser on how long to wait before reconnecting
sse-retry 5000
