#!/bin/sh
# assert-success - test assertion that STATUS equals 0
# Testing imp - fails if STATUS variable is not 0
# Example: assert-success || return 1

_test_assert_success() {
  if [ "${STATUS:-1}" -ne 0 ]; then
    if [ -n "${ERROR-}" ]; then
      TEST_FAILURE_REASON="expected status 0 but got $STATUS; stderr: $ERROR"
    else
      TEST_FAILURE_REASON="expected status 0 but got $STATUS"
    fi
    return 1
  fi
}

# Self-execute when run directly (not sourced)
case "$0" in
  */test-assert-success) _test_assert_success "$@" ;; esac
