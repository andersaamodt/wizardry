#!/bin/sh
# write-pacman-stub FIXTURE - create a pacman stub script in fixture/bin
# Stub logs invocations to PACMAN_LOG and exits with PACMAN_EXIT code.
set -eu

_write_pacman_stub() {
  fixture=$1
  cat <<'STUB' >"$fixture/bin/pacman"
#!/bin/sh
echo "$0 $*" >>"${PACMAN_LOG:?}" || exit 1
exit ${PACMAN_EXIT:-0}
STUB
  chmod +x "$fixture/bin/pacman"
}

# Self-execution when run directly (not sourced)
set -eu
case "${0##*/}" in write-pacman-stub) _write_pacman_stub "$@" ;; esac
