#!/bin/sh
# assert-failure [STATUS] - verify status is non-zero
# If STATUS not provided, reads from $STATUS variable for backward compatibility.
# Sets TEST_FAILURE_REASON if status was 0.
set -eu

status_arg=${1:-${STATUS-0}}
if [ "$status_arg" -eq 0 ]; then
  TEST_FAILURE_REASON="expected failure status but got success"
  export TEST_FAILURE_REASON
  printf '%s' "$TEST_FAILURE_REASON" > "${WIZARDRY_TMPDIR}/_test_failure_reason" 2>/dev/null || true
  exit 1
fi
exit 0


