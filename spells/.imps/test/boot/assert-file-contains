#!/bin/sh
# assert-file-contains FILE SUBSTRING - verify file contains the substring
# Sets TEST_FAILURE_REASON on mismatch or missing file.
set -eu

assert_file_contains() {
  file=$1
  substring=$2
  if [ ! -f "$file" ]; then
    TEST_FAILURE_REASON="expected file missing: $file"
    return 1
  fi

  if grep -F -- "$substring" "$file" >/dev/null 2>&1; then
    return 0
  fi

  TEST_FAILURE_REASON="file $file missing substring: $substring"
  return 1
}

# Self-execution when run directly (not sourced)
case "${0##*/}" in assert-file-contains) assert_file_contains "$@" ;; esac
