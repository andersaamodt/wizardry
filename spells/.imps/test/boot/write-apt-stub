#!/bin/sh
# write-apt-stub FIXTURE - create an apt-get stub script in fixture/bin
# Stub logs invocations to APT_LOG and exits with APT_EXIT code.

set -eu
. env-clear

_write_apt_stub() {
  fixture=$1
  cat <<'STUB' >"$fixture/bin/apt-get"
#!/bin/sh
echo "$0 $*" >>"${APT_LOG:?}" || exit 1
exit ${APT_EXIT:-0}
STUB
  chmod +x "$fixture/bin/apt-get"
}

# Self-execution when run directly (not sourced)
case "${0##*/}" in write-apt-stub) _write_apt_stub "$@" ;; esac
