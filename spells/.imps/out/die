#!/bin/sh
# die [CODE] MESSAGE - print to stderr and exit with error code (default 1)
# Examples: die "fatal error" | die 2 "file not found"
set -eu

# Redirect stdin from /dev/null to prevent hanging on macOS
exec </dev/null

case "$1" in
  [0-9]|[0-9][0-9]|[0-9][0-9][0-9]) _die_code=$1; shift ;;
  *) _die_code=1 ;;
esac
printf '%s\n' "$*" >&2
exit "$_die_code"
