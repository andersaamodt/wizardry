#!/bin/sh
# setup-imps-path - Add .imps and all subdirectories to PATH for spell execution
# This ensures env-clear and other imps are findable even in restricted PATH environments.
# Usage: . setup-imps-path (must be sourced, not executed)

# Locate imps directory relative to script location
_setup_script_dir=$(CDPATH= cd -- "$(dirname "$0")" && pwd -P)
_setup_imps_dir="$_setup_script_dir/../.imps"

# Add .imps and its subdirectories to PATH
if [ -d "$_setup_imps_dir" ]; then
  PATH="$_setup_imps_dir:$PATH"
  for _setup_impsubdir in "$_setup_imps_dir"/*; do
    [ -d "$_setup_impsubdir" ] || continue
    PATH="$_setup_impsubdir:$PATH"
  done
fi
export PATH

# Clean up temporary variables
unset _setup_script_dir _setup_imps_dir _setup_impsubdir
