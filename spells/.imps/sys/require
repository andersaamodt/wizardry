#!/bin/sh
# require COMMAND [MESSAGE] - wrapper for require-command dependency checks
# Delegates to require-command (if available), honoring REQUIRE_COMMAND override.
# Falls back to a simple command check if require-command is not available.
# Example: require menu "The menu command is needed"

if [ $# -eq 0 ]; then
  printf '%s\n' "require: command argument required" >&2
  exit 1
fi

tool=$1
shift

# Determine which require-command to use
if [ -n "${REQUIRE_COMMAND-}" ]; then
	require_cmd=$REQUIRE_COMMAND
elif command -v require-command >/dev/null 2>&1; then
	require_cmd=require-command
else
	require_cmd=""
fi

# If we have a require-command, use it
if [ -n "$require_cmd" ]; then
	"$require_cmd" "$tool" "$@"
	exit $?
fi

# Fallback: simple command check when require-command is not available
if command -v "$tool" >/dev/null 2>&1; then
	exit 0
fi

# Command not found - show error message
if [ "$#" -gt 0 ]; then
	printf '%s\n' "$*" >&2
else
	printf '%s\n' "require: missing required command '$tool'" >&2
fi
printf '%s\n' "Visit 'install-menu' to review installation options." >&2
exit 1
