#!/bin/sh
# spell-levels LEVEL FIELD - output specific field for a level
# Fields: name, spells, imps
# Usage: 
#   name=$(spell-levels 4 name)
#   spells=$(spell-levels 4 spells)
#   imps=$(spell-levels 4 imps)
set -eu

_level="${1:-}"
_field="${2:-all}"

case "$_level" in
  0)
    _name='POSIX & Platform Foundation'
    _spells='detect-posix:divination detect-distro:divination verify-posix:.wizardry'
    _imps=''
    ;;
  1)
    _name='Banish & Validation Infrastructure'
    _spells='banish:wards validate-spells:.wizardry'
    _imps='sys/spell-levels cond/has cond/there cond/is cond/empty cond/nonempty cond/no cond/within-range cond/lacks cond/newer cond/full cond/gone cond/is-path cond/has-ancestor cond/is-posint cond/yes cond/given cond/older out/say out/warn out/die out/fail out/info out/step out/success out/debug out/ok out/heading-section out/heading-separator out/heading-simple out/usage-error out/first-of out/or-else out/print-pass out/print-fail out/disable-palette out/quiet text/pluralize text/count-words'
    ;;
  2)
    _name='Installation Infrastructure'
    _spells=''
    _imps='declare-globals sys/invoke-wizardry sys/invoke-thesaurus sys/require-wizardry sys/require sys/env-clear sys/env-or sys/on-exit sys/clear-traps sys/on sys/now sys/any sys/need sys/must sys/uncastable sys/where sys/autocast sys/ask-install-wizardry sys/clipboard-available sys/nix-shell-add sys/nix-shell-remove sys/nix-shell-status sys/nix-rebuild fs/temp-file fs/temp-dir fs/cleanup-file fs/cleanup-dir input/tty-save input/tty-restore input/tty-raw input/read-line str/contains str/trim str/equals str/starts str/ends str/lower str/upper str/seeks str/differs str/matches paths/here paths/parent paths/file-name paths/abs-path paths/make paths/path paths/tilde-path paths/strip-trailing-slashes paths/norm-path paths/script-dir paths/temp'
    ;;
  3)
    _name='Glossary System'
    _spells='generate-glosses:.wizardry'
    _imps='lex/parse fs/find-executable'
    ;;
  4)
    _name='Menu System'
    _spells='menu fathom-terminal fathom-cursor move-cursor await-keypress cursor-blink colors main-menu:menu'
    _imps='menu/is-submenu menu/is-integer menu/category-title menu/exit-label menu/is-installable'
    ;;
  5)
    _name='MUD Basics'
    _spells='check-cd-hook:mud look:mud'
    _imps='fs/xattr-helper-usable fs/xattr-list-keys fs/xattr-read-value'
    ;;
  6)
    _name='Navigation'
    _spells='jump-to-marker:translocation mark-location:translocation'
    _imps=''
    ;;
  7)
    _name='Arcane File Operations'
    _spells='copy:arcane trash:arcane jump-trash:arcane forall:arcane read-magic:arcane file-list:arcane'
    _imps='fs/backup fs/clip-copy fs/clip-paste fs/ensure-parent-dir menu/detect-trash text/read-file text/write-file text/lines text/each text/append text/count-chars text/make-indent text/drop text/last text/take text/skip text/first text/pick text/field'
    ;;
  8)
    _name='Basic Cantrips'
    _spells='ask ask-yn ask-text list-files max-length move up'
    _imps='input/choose-input lex/from lex/to lex/and-then lex/into lex/disambiguate'
    ;;
  9)
    _name='Validation Helpers'
    _spells='validate-number validate-path require-command'
    _imps='input/validate-command input/validate-name lex/and lex/or'
    ;;
  10)
    _name='Advanced Cantrips'
    _spells='ask-number memorize'
    _imps=''
    ;;
  11)
    _name='System Configuration'
    _spells='config:system logs:system package-managers:system learn-spellbook:system'
    _imps='fs/config-get fs/config-set fs/config-has fs/config-del pkg/pkg-manager pkg/pkg-has pkg/pkg-install pkg/pkg-remove pkg/pkg-update pkg/pkg-upgrade'
    ;;
  12)
    _name='Testing Infrastructure'
    _spells='test-spell:.wizardry test-magic:.wizardry pocket-dimension:system logging-example wizard-eyes'
    _imps='test/boot/assert-error-contains test/boot/assert-failure test/boot/assert-file-contains test/boot/assert-output-contains test/boot/assert-path-exists test/boot/assert-path-missing test/boot/assert-status test/boot/assert-success test/boot/find-repo-root test/boot/finish-tests test/boot/init-test-counters test/boot/link-tools test/boot/make-fixture test/boot/make-tempdir test/boot/provide-basic-tools test/boot/record-failure-detail test/boot/report-result test/boot/run-bwrap test/boot/run-cmd test/boot/run-macos-sandbox test/boot/run-spell test/boot/run-spell-in-dir test/boot/run-test-case test/boot/skip-if-compiled test/boot/skip-if-uncompiled test/boot/stub-nix-env test/boot/stub-pacman test/boot/test-fail test/boot/test-heading test/boot/test-lack test/boot/test-pass test/boot/test-skip test/boot/test-summary test/boot/write-apt-stub test/boot/write-command-stub test/boot/write-pkgin-stub test/boot/write-sudo-stub test/stub-cursor-blink test/stub-fathom-terminal test/stub-stty test/stub-await-keypress test/stub-fathom-cursor test/stub-move-cursor test/test-bootstrap sys/rc-add-line sys/rc-has-line sys/rc-remove-line'
    ;;
  13)
    _name='System Maintenance'
    _spells='update-wizardry:.wizardry update-all:system kill-process:system'
    _imps='fs/backup-nix-config'
    ;;
  14)
    _name='Advanced System Tools'
    _spells='demo-magic:spellcraft wizard-cast'
    _imps=''
    ;;
  15)
    _name='Divination'
    _spells='detect-rc-file:divination detect-magic:divination identify-room:divination'
    _imps='sys/os sys/term text/detect-indent-char text/detect-indent-width lang/possessive'
    ;;
  16)
    _name='Advanced MUD Features'
    _spells='decorate:mud choose-player:mud'
    _imps=''
    ;;
  17)
    _name='Cryptography'
    _spells='hash:crypto evoke-hash:crypto hashchant:crypto'
    _imps=''
    ;;
  18)
    _name='SSH & Remote Access'
    _spells='validate-ssh-key enchant-portkey:translocation follow-portkey:translocation open-portal:translocation open-teletype:translocation reload-ssh restart-ssh'
    _imps=''
    ;;
  19)
    _name='Task Priorities'
    _spells='get-priority:priorities get-new-priority:priorities prioritize:priorities upvote:priorities'
    _imps=''
    ;;
  20)
    _name='Security Wards'
    _spells='ssh-barrier:wards'
    _imps='fs/sed-inplace'
    ;;
  21)
    _name='Extended Attributes'
    _spells='enchant:enchant disenchant:enchant enchantment-to-yaml:enchant yaml-to-enchantment:enchant'
    _imps=''
    ;;
  22)
    _name='Process & System Info (PSI)'
    _spells='list-contacts:psi read-contact:psi'
    _imps=''
    ;;
  23)
    _name='Spellcraft Development Tools'
    _spells='scribe-spell:spellcraft lint-magic:spellcraft compile-spell:spellcraft learn:spellcraft forget:spellcraft erase-spell:spellcraft doppelganger:spellcraft add-synonym:spellcraft edit-synonym:spellcraft delete-synonym:spellcraft reset-default-synonyms:spellcraft bind-tome:spellcraft unbind-tome:spellcraft merge-yaml-text:spellcraft catalog-emojis:spellcraft'
    _imps=''
    ;;
  24)
    _name='Core Menu Infrastructure'
    _spells='spellbook-store spellbook:menu cast:menu spell-menu:menu'
    _imps=''
    ;;
  25)
    _name='System & Configuration Menus'
    _spells='system-menu:menu install-menu:menu synonym-menu:menu thesaurus:menu'
    _imps=''
    ;;
  26)
    _name='MUD Administration Menus'
    _spells='mud:menu mud-menu:menu mud-settings:menu mud-admin-menu:menu add-ssh-player:menu/mud-admin new-player:menu/mud-admin set-player:menu/mud-admin'
    _imps=''
    ;;
  27)
    _name='Domain-Specific Menus'
    _spells='network-menu:menu services-menu:menu shutdown-menu:menu priority-menu:menu priorities:menu users-menu:menu profile-tests:menu/system'
    _imps=''
    ;;
  28)
    _name='System Service Management'
    _spells='install-service-template is-service-installed enable-service disable-service start-service stop-service restart-service service-status remove-service'
    _imps=''
    ;;
  29)
    _name='Arcana & Extensions'
    _spells='bitcoin-menu:.arcana/bitcoin bitcoin-status:.arcana/bitcoin cd:.arcana/mud change-bitcoin-directory:.arcana/bitcoin configure-bitcoin:.arcana/bitcoin configure-tor-bridge:.arcana/tor configure-tor:.arcana/tor core-menu:.arcana/core core-status:.arcana/core import-arcanum:.arcana install-bitcoin:.arcana/bitcoin install-bwrap:.arcana/core install-cd:.arcana/mud install-checkbashisms:.arcana/core install-clipboard-helper:.arcana/core install-core:.arcana/core install-dd:.arcana/core install-git:.arcana/core install-lightning:.arcana/lightning install-mud:.arcana/mud install-node:.arcana/node install-simplex-chat:.arcana/simplex-chat install-stty:.arcana/core install-tor:.arcana/tor install-tput:.arcana/core install-wl-clipboard:.arcana/core install-xclip:.arcana/core install-xsel:.arcana/core is-bitcoin-installed:.arcana/bitcoin is-bitcoin-running:.arcana/bitcoin lightning-menu:.arcana/lightning lightning-status:.arcana/lightning lightning-wallet-menu:.arcana/lightning manage-system-command:.arcana/core mud-config:.arcana/mud node-menu:.arcana/node node-status:.arcana/node repair-bitcoin-permissions:.arcana/bitcoin repair-tor-permissions:.arcana/tor setup-tor:.arcana/tor simplex-chat-menu:.arcana/simplex-chat simplex-chat-status:.arcana/simplex-chat toggle-all-mud:.arcana/mud toggle-cd:.arcana/mud toggle-combat:.arcana/mud toggle-fantasy-theme:.arcana/mud toggle-inventory:.arcana/mud toggle-mud-menu:.arcana/mud toggle-touch-hook:.arcana/mud tor-bridge-status:.arcana/tor tor-menu:.arcana/tor tor-status:.arcana/tor torrc-path:.arcana/tor uninstall-bitcoin:.arcana/bitcoin uninstall-bwrap:.arcana/core uninstall-clipboard-helper:.arcana/core uninstall-core:.arcana/core uninstall-dd:.arcana/core uninstall-git:.arcana/core uninstall-lightning:.arcana/lightning uninstall-node:.arcana/node uninstall-simplex-chat:.arcana/simplex-chat uninstall-stty:.arcana/core uninstall-tor:.arcana/tor uninstall-tput:.arcana/core uninstall-wl-clipboard:.arcana/core uninstall-xclip:.arcana/core uninstall-xsel:.arcana/core wallet-menu:.arcana/bitcoin'
    _imps=''
    ;;
  *)
    exit 1
    ;;
esac

case "$_field" in
  name) printf '%s\n' "$_name" ;;
  spells) printf '%s\n' "$_spells" ;;
  imps) printf '%s\n' "$_imps" ;;
  all)
    printf 'name=%s\n' "$_name"
    printf 'spells=%s\n' "$_spells"
    printf 'imps=%s\n' "$_imps"
    ;;
  *)
    printf 'spell-levels: unknown field: %s\n' "$_field" >&2
    exit 1
    ;;
esac
