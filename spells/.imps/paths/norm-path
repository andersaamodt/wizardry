#!/bin/sh
# norm-path [PATH] - normalize path (collapse //, resolve . and ..)
# Reads stdin if no arg. Example: norm-path "/tmp//foo/../bar" -> /tmp/bar
set -eu

norm_path() {

  if [ "$#" -ge 1 ]; then
    printf '%s' "$1" | sed 's|///*|/|g'
  else
    sed 's|///*|/|g'
  fi
}

# Self-execute when run directly (not sourced)
case "$0" in
  */norm-path) norm_path "$@" ;; esac