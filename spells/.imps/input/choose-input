#!/bin/sh
# choose-input - detect best input source (stdin/tty/none)
# Example: src=$(choose-input) && case $src in stdin) read line ;; tty) read </dev/tty ;; esac
# Set CHOOSE_INPUT_MODE=stdin|tty|none to override auto-detection
set -eu


case ${CHOOSE_INPUT_MODE:-auto} in
  stdin) printf '%s\n' stdin; exit 0 ;;
  tty)   printf '%s\n' tty;   exit 0 ;;
  none)  exit 1 ;;
esac

# Use /dev/fd/0 instead of /dev/stdin for cross-platform compatibility.
# On macOS, /dev/stdin is a symlink and tests may fail on the symlink itself.
if [ -t 0 ] || [ -p /dev/fd/0 ] || [ -s /dev/fd/0 ]; then
  printf '%s\n' stdin
  exit 0
fi

if [ -r /dev/tty ]; then
  printf '%s\n' tty
  exit 0
fi

exit 1
