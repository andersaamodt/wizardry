#!/bin/sh
# validate-command COMMAND CONTEXT - validate command is non-empty, single-line, no tabs
# Example: validate-command "$cmd" "spell" || exit 1

set -eu

_vc_cmd=${1-}
_vc_context=${2:-command}

if [ -z "$_vc_cmd" ]; then
  printf '%s\n' "${_vc_context} must not be empty." >&2
  exit 1
fi

if [ "$(printf '%s' "$_vc_cmd" | tr -d '\t')" != "$_vc_cmd" ]; then
  printf '%s\n' "${_vc_context} may not contain tabs." >&2
  exit 1
fi

if [ "$(printf '%s' "$_vc_cmd" | tr -d '\n')" != "$_vc_cmd" ]; then
  printf '%s\n' "${_vc_context} must be a single line." >&2
  exit 1
fi

exit 0
