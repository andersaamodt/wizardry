#!/bin/sh
# select-input - detect best input source (stdin/tty/none)
# Example: src=$(select-input) && case $src in stdin) read line ;; tty) read </dev/tty ;; esac
# Set SELECT_INPUT_MODE=stdin|tty|none to override auto-detection

_select_input() {
  case ${SELECT_INPUT_MODE:-auto} in
    stdin) printf '%s\n' stdin; return 0 ;;
    tty)   printf '%s\n' tty;   return 0 ;;
    none)  return 1 ;;
  esac

  if [ -t 0 ] || [ -p /dev/stdin ] || [ -s /dev/stdin ]; then
    printf '%s\n' stdin
    return 0
  fi

  if [ -r /dev/tty ]; then
    printf '%s\n' tty
    return 0
  fi

  return 1
}

# Self-execute when run directly (not sourced)
case "$0" in
  */select-input) _select_input "$@" ;; esac
