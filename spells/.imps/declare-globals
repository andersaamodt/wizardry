#!/bin/sh
# declare-globals - centralized declaration of all allowed global environment variables.
#
# When sourced in a script that uses `set -u`, this imp prevents undeclared global
# environment variables from being used. Every global must be declared here with a
# justification comment explaining why it is required.
#
# Usage: . declare-globals
#        (Source this file at the start of scripts that need strict global checking.)
#
# After sourcing, scripts with `set -u` will fail if they reference undeclared globals.
# Add new globals here with a justification comment when absolutely necessary.
#
# IMPORTANT: Use globals only for true global state, not as arguments!
# - PREFER: Pass configuration via --flag arguments
# - AVOID: Using globals to pass values between scripts (use args instead)
# - OK: Directory paths that coordinate multiple independent spells
# - OK: Test infrastructure state that spans multiple test processes

# =============================================================================
# DECLARED GLOBALS (each must have a justification comment above it)
# =============================================================================

# --- Core Installation ---

# Directory where wizardry is installed. Required for scripts to locate
# resources relative to the installation root.
: "${WIZARDRY_DIR:=}"

# --- User Data ---

# Directory for user's spellbook. Contains user-created spells and the
# .memorized file for the cast menu. Required for spell storage coordination.
: "${SPELLBOOK_DIR:=}"

# Spellbook storage file location. Used by spellbook-store for testing purposes.
# Internal/test use only - default location is $HOME/.tower/spellbook.
: "${SPELLBOOK_FILE:=}"

# MUD configuration directory. Required for MUD features to know where
# to store room descriptions and other MUD-related configuration.
: "${MUD_DIR:=}"

# --- learn-spell Inter-Process Communication ---
# (These are set by learn-spell wrapper, not user-facing globals)

# Shell RC file path from learn-spell. Set by the wrapper script to pass
# detected shell config to install() functions without re-detection.
: "${LEARN_SPELL_RC_FILE:=}"

# Format of the shell RC file. Set by wrapper to pass format info.
: "${LEARN_SPELL_RC_FORMAT:=}"

# Shell platform identifier. Set by wrapper to pass platform info.
: "${LEARN_SPELL_PLATFORM:=}"

# Target spell path during installation. Set by wrapper to communicate
# the spell's path to install() functions.
: "${LEARN_SPELL_TARGET:=}"

# --- Test Infrastructure ---
# (WIZARDRY_ prefix for namespacing in test environments)

# Flag to load only test helpers, not full spell functionality.
: "${WIZARDRY_TEST_HELPERS_ONLY:=}"

# Temporary directory for wizardry test operations.
: "${WIZARDRY_TMPDIR:=}"

# System PATH saved before test PATH modifications.
: "${WIZARDRY_SYSTEM_PATH:=}"

# Flag to disable sandbox in tests.
: "${WIZARDRY_DISABLE_SANDBOX:=}"

# Flag to enable macOS sandbox (disabled by default).
: "${WIZARDRY_ENABLE_MACOS_SANDBOX:=}"

# Flag indicating sandbox warning already shown.
: "${WIZARDRY_BWRAP_WARNING:=}"

# Path to sandbox warning flag file.
: "${WIZARDRY_BWRAP_WARN_FILE:=}"
