#!/bin/sh

# This 'look' spell is the most basic command in the MUD.
# Use it to look around a room (no arg provided), or look at a specific object (by providing its relative or absolute path).
# When you look at a room or object, it will print that object's "description" extended attribute.

source colors

path=$1

if [ -z "$path" ]; then
  path="$PWD"
fi

install_look(){
  if ! grep -q "alias look='${BASH_SOURCE[0]}'" ~/.bashrc; then
    echo "'Look' is a reserved keyword, so you must memorize this spell to change the meaning of the word 'look'." 
    echo "Do you wish to memorize this spell? (yes/no)"
    read -r answer
    if [ "$answer" == "yes" ]; then
      echo "alias look='${BASH_SOURCE[0]}'" >> ~/.bashrc
      echo "Spell memorized in .bashrc, so you will always be able to use it."
    else
      echo "The mud will only run in this shell window."
    fi
  fi
}

install_look

name=$(read-magic "$path" name)
description=$(read-magic "$path" description)

if [ "$name" != "Error: The attribute does not exist." ] || [ "$description" != "Error: The attribute does not exist." ]; then
  if [ "$name" != "Error: The attribute does not exist." ]; then
		printf "${BLUE}${BOLD}$name${RESET}\n"
	fi
	
	if [ "$description" != "Error: The attribute does not exist." ]; then
	  echo $description
	fi
else
  echo "You look, but you don't see anything."
fi
