name: "Hypothesis #116 - Command substitution depth limit"
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    env:
      WIZARDRY_OS_LABEL: ubuntu
    steps:
      - uses: actions/checkout@v4
      - run: chmod +x install spells/.wizardry/generate-glosses
      - run: ./install
      - run: |
          echo "Strategy: Check for deeply nested command substitutions that bash might handle differently"
          ~/.wizardry/spells/.wizardry/generate-glosses > /tmp/glosses.sh
          echo "Searching for nested $():"
          grep -o '\$([^)]*\$(' /tmp/glosses.sh | head -n 20 || echo "No nested command subst found"
          echo "---"
          echo "Searching for backticks:"
          grep '`' /tmp/glosses.sh | head -n 20 || echo "No backticks found"
      - run: banish 8 && test-magic --verbose
